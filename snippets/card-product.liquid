<div class="card-product bg-white shadow p-3 flex flex-col text-left relative {{ extra_class | default: '' }}">

  {% assign price = product.selected_or_first_available_variant.price %}
  {% assign compare_at_price = product.selected_or_first_available_variant.compare_at_price %}
  
  {% if compare_at_price and price and compare_at_price > price %}
    {% assign discount = compare_at_price | minus: price %}
    {% assign discount_percentage = discount | times: 1.0 | divided_by: compare_at_price | times: 100 | round %}
    <div class="absolute top-2 right-2 bg-red-500 text-white text-xs font-semibold px-2 py-1 rounded z-10">
      {{ discount_percentage }}% OFF
    </div>
  {% endif %}

  <div class="card-product__image flex-[0_0_65%] min-h-0 flex items-center justify-center bg-[#F3F8F6] rounded-[10px]">
    {% if product.featured_image %}
      <a href="{{ product.url }}">
        <img 
          src="{{ product.featured_image | image_url: width: 250, height: 350, crop: 'center' }}" 
          alt="{{ product.title }}" 
          width="500" 
          height="500"
          class="w-full h-full object-cover rounded-[10px] transition-transform duration-300 ease-in-out transform hover:scale-105"
        />
      </a>
    {% else %}
      <div class="w-40 h-40 bg-gray-100 flex items-center justify-center mb-4">
        <span class="text-gray-400 text-sm">No Image</span>
      </div>
    {% endif %}
  </div>

  <div class="card-product__info flex-1 min-h-0 flex flex-col justify-between gap-2 mt-2">
    
    <h3 class="card-product__title text-[15px] font-semibold leading-[1.3] overflow-hidden line-clamp-2 min-h-[20px]">
      <a href="{{ product.url }}" class="block relative text-gray-900 hover:text-gray-900 group">
        {{ product.title }}
      </a>
    </h3>

    <div class="flex items-center gap-2 mt-auto min-h-[20px]">
      <div class="flex text-gray-300 text-xl">★★★★★</div>
      <span class="text-gray-500 text-sm">
        0 reviews
      </span>
    </div>

    <div class="card-product__price text-[18px] font-bold text-[#d10000] min-h-[24px]">
      <span>{{ price | money }}</span>
      {% if compare_at_price and compare_at_price > price %}
        <span class="line-through text-gray-400 ml-2">{{ compare_at_price | money }}</span>
      {% endif %}
    </div>

  </div>

  <div class="card-product__button flex-[0_0_10%] flex items-end mt-auto">
    <a href="{{ product.url }}" 
       class="relative overflow-hidden border border-green-700 text-green-700 rounded-lg 
              px-4 py-2 w-full text-center transition group">
      <span class="relative z-10 group-hover:text-white">CHOOSE OPTIONS</span>
      <span class="absolute inset-0 bg-green-700 -translate-x-full 
                   transition-transform duration-300
                   group-hover:translate-x-0"></span>
    </a>
  </div>

</div>
